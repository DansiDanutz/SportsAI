---
phase: 02-verification-testing
plan: 02
type: execute
wave: 1
depends_on: []
files_modified: []
autonomous: false
user_setup: []

must_haves:
  truths:
    - "Backend health check returns 200 OK at https://sportsapiai.onrender.com/health"
    - "User can create account via signup form"
    - "User can login with credentials"
    - "Authenticated requests return user profile data"
  artifacts:
    - path: "https://sportsapiai.onrender.com/health"
      provides: "Backend health status endpoint"
    - path: ".planning/phases/02-verification-testing/02-02-SUMMARY.md"
      provides: "Auth flow verification results"
  key_links:
    - from: "Frontend"
      to: "https://sportsapiai.onrender.com"
      via: "vercel.json rewrite rule or direct API_BASE_URL"
      pattern: "/api -> https://sportsapiai.onrender.com"
    - from: "Browser"
      to: "Backend"
      via: "CORS preflight and authenticated requests"
      pattern: "Access-Control-Allow-Origin header present"
---

<objective>
Verify authentication flow and API communication between Vercel frontend and Render backend

Purpose: Ensure users can signup, login, and make authenticated API requests successfully
Output: Auth flow verification report with CORS status and any issues found
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Deployment context
Frontend URL: https://sports-ai-one.vercel.app
Backend URL: https://sportsapiai.onrender.com
Health endpoint: /health
Auth endpoints: /v1/auth/signup, /v1/auth/login, /v1/auth/me
</context>

<tasks>

<task type="auto">
  <name>Task 1: Test Backend Health Endpoint</name>
  <files>none (API test)</files>
  <action>
    Use curl or browser to test the backend health endpoint:

    1. Test health endpoint:
    ```bash
    curl -i https://sportsapiai.onrender.com/health
    ```

    2. Verify:
       - HTTP status is 200 OK
       - Response contains: {"status":"ok","service":"sportsai-backend",...}
       - Response time is reasonable (<5 seconds)
       - No CORS errors in browser console when accessing from frontend

    3. Note any issues:
       - timeouts
       - 5xx errors
       - unexpected response format
  </action>
  <verify>curl command returns 200 OK with valid JSON response</verify>
  <done>Backend health check confirms service is running and accessible</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Test Authentication Flow (Signup and Login)</name>
  <action>No automated action - this is a verification checkpoint</action>
  <verify>
    Manual browser testing:

    1. Navigate to: https://sports-ai-one.vercel.app
    2. Open Developer Tools (F12) - Console tab and Network tab
    3. Test SIGNUP:
       - Click "Sign Up" or "Register" button
       - Enter test email: test-verification-{timestamp}@example.com
       - Enter strong password (8+ chars, uppercase, lowercase, number, special)
       - Submit form
       - Check Network tab for:
         * POST request to /api/v1/auth/signup
         * Response status 201 or 200
         * Set-Cookie headers for auth tokens
       - Check Console for any errors

    4. Test LOGIN:
       - Logout if auto-logged in after signup
       - Click "Login" button
       - Enter the same email and password
       - Submit form
       - Check Network tab for:
         * POST request to /api/v1/auth/login
         * Response status 200
         * Set-Cookie headers present
       - Verify redirect or UI shows authenticated state

    5. Test AUTHENTICATED REQUEST:
       - After login, check if profile/user data loads
       - Look for GET request to /api/v1/auth/me
       - Verify response contains user object with email

    6. Check CORS:
       - In Network tab, check any /api/* requests
       - Look for Access-Control-Allow-Origin header
       - Should show the Vercel frontend URL

    Document:
    - Each step success/failure
    - HTTP status codes
    - Response bodies (relevant parts)
    - Any console errors
    - CORS headers present
    - Cookies set correctly
  </verify>
  <done>
    Auth flow verification complete with:
    - Signup success/failure status
    - Login success/failure status
    - Authenticated request success/failure
    - CORS configuration status
    - Any errors or issues requiring fixes
  </done>
</task>

<task type="auto">
  <name>Task 3: Document Auth Flow Verification Results</name>
  <files>.planning/phases/02-verification-testing/02-02-SUMMARY.md</files>
  <action>
    Create a SUMMARY.md file documenting the auth verification results:

    Use the following template:

    ```markdown
    # Plan 02-02 Summary: Authentication Flow Verification

    ## Verification Date
    [Date and time of verification]

    ## Backend Health Check
    - URL: https://sportsapiai.onrender.com/health
    - Status: [HTTP status code]
    - Response time: [X ms]
    - Response body: [JSON snippet]

    ## Signup Flow Test
    - Status: [SUCCESS/FAILED]
    - Test email used: [test email]
    - HTTP status: [200/201/4xx/5xx]
    - Cookies set: [YES/NO]
    - Console errors: [NONE or list]

    ## Login Flow Test
    - Status: [SUCCESS/FAILED]
    - HTTP status: [200/4xx/5xx]
    - Cookies set: [YES/NO]
    - Redirect/ UI update: [Working/Not working]
    - Console errors: [NONE or list]

    ## Authenticated Request Test
    - Endpoint: /api/v1/auth/me
    - Status: [SUCCESS/FAILED]
    - Response received: [YES/NO]
    - User data in response: [YES/NO]

    ## CORS Configuration
    - Access-Control-Allow-Origin header: [Present/Missing]
    - Origin value: [actual value or "not set"]
    - Access-Control-Allow-Credentials: [true/false]
    - Preflight OPTIONS requests: [Success/Fail]

    ## Issues Identified
    [List any issues with CORS, auth, cookies, etc.]

    ## Required Fixes (if any)
    [List specific fixes needed with file locations]
    ```
  </action>
  <verify>File .planning/phases/02-verification-testing/02-02-SUMMARY.md exists with complete auth verification results</verify>
  <done>Auth flow verification summary document created with all test results</done>
</task>

</tasks>

<verification>
After completion:
- Backend health check passes
- Auth flow (signup/login) works or issues are documented
- CORS configuration verified
- SUMMARY.md contains detailed results
- Any fixes needed are clearly identified
</verification>

<success_criteria>
1. Backend health endpoint returns 200 OK
2. Signup and login forms submit successfully
3. Authenticated API requests work
4. CORS headers properly configured
5. All results documented in SUMMARY.md
</success_criteria>

<output>
After completion, create `.planning/phases/02-verification-testing/02-02-SUMMARY.md`
</output>
